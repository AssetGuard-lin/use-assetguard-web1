<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AssetGuard Pro</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">
    <style>
        :root { --primary:#0072CE; --bg:#f4f7fe; }
        *{margin:0;padding:0;box-sizing:border-box;font-family:Poppins,sans-serif;}
        body{background:var(--bg);height:100vh;display:flex;align-items:center;justify-content:center;}
        .login-card{
            background:#fff;
            padding:40px;
            border-radius:25px;
            width:90%;
            max-width:380px;
            text-align:center;
            box-shadow:0 20px 50px rgba(0,0,0,.08);
        }
        h2 { color: #333; margin-bottom: 10px; }
        #status-text { font-size: 14px; color: #666; margin-bottom: 20px; }
        input{
            width:100%;
            padding:14px;
            margin:10px 0;
            border-radius:10px;
            border:2px solid #eee;
            outline: none;
        }
        input:focus { border-color: var(--primary); }
        button{
            width:100%;
            padding:15px;
            background:var(--primary);
            color:#fff;
            border:none;
            border-radius:12px;
            font-weight:700;
            cursor:pointer;
            margin-top: 10px;
            transition: background 0.3s;
        }
        button:disabled { background: #ccc; }
    </style>
</head>
<body>

<div class="login-card">
    <h2>AssetGuard</h2>
    <p id="status-text">Enter credentials to connect</p>

    <input id="user" type="text" placeholder="Username" autocomplete="username">
    <input id="pass" type="password" placeholder="Password" autocomplete="current-password">

    <button id="login-btn" onclick="attemptLogin()">Login</button>
</div>

<script>
function attemptLogin(){
    let u = document.getElementById("user").value.trim();
    let p = document.getElementById("pass").value.trim();

    if(!u || !p){
        alert("Please fill in all fields");
        return;
    }

    const status = document.getElementById("status-text");
    const btn = document.getElementById("login-btn");

    status.innerText = "Authenticating...";
    status.style.color = "#0072CE";
    btn.disabled = true;

    // Direct call to your API
    // NOTE: Wuaze security may still block this "Cross-Origin" request.
    fetch("https://assetguard.wuaze.com/api.php", {
        method: "POST",
        headers: {
            "Content-Type": "application/x-www-form-urlencoded"
        },
        body: "action=login&u=" + encodeURIComponent(u) + "&p=" + encodeURIComponent(p)
    })
    .then(res => res.text())
    .then(txt => {
        txt = txt.trim();
        if(txt === "SUCCESS" || txt === "OK"){
            status.innerText = "Login Successful!";
            status.style.color = "green";
            
            // Tell your Kodular/App Inventor app that login worked
            if(window.AppInventor){
                window.AppInventor.setWebViewString("LOGIN_SUCCESS");
            }
        } else {
            status.innerText = "Error: " + txt;
            status.style.color = "red";
            btn.disabled = false;
        }
    })
    .catch(err => {
        status.innerText = "Connection Error. Check your internet.";
        status.style.color = "red";
        btn.disabled = false;
        console.error(err);
    });
}
</script>

</body>
</html>
